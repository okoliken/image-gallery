(function(e,r){typeof exports=="object"&&typeof module<"u"?module.exports=r(require("vue")):typeof define=="function"&&define.amd?define(["vue"],r):(e=typeof globalThis<"u"?globalThis:e||self,e.MasonryWall=r(e.Vue))})(this,function(e){"use strict";const r=["data-index"],x=e.defineComponent({__name:"masonry-wall",props:{columnWidth:{default:400},items:null,gap:{default:0},rtl:{type:Boolean,default:!1},ssrColumns:{default:0}},emits:["redraw","redrawSkip"],setup(s,{emit:m}){const C=s,{columnWidth:w,items:c,gap:i,rtl:h,ssrColumns:y}=e.toRefs(C),u=e.ref([]),f=e.ref();function g(){const n=Math.floor((f.value.getBoundingClientRect().width+i.value)/(w.value+i.value));return n>0?n:1}function k(n){return[...new Array(n)].map(()=>[])}if(y.value>0){const n=k(y.value);c.value.forEach((o,a)=>n[a%y.value].push(a)),u.value=n}async function B(n){if(n>=c.value.length)return;await e.nextTick();const o=[...f.value.children];h.value&&o.reverse();const a=o.reduce((d,t)=>t.getBoundingClientRect().height<d.getBoundingClientRect().height?t:d);u.value[+a.dataset.index].push(n),await B(n+1)}async function p(n=!1){if(u.value.length===g()&&!n){m("redrawSkip");return}u.value=k(g());const o=window.scrollY;await B(0),window.scrollTo({top:o}),m("redraw")}const l=typeof ResizeObserver>"u"?void 0:new ResizeObserver(()=>p());return e.onMounted(()=>{p(),l==null||l.observe(f.value)}),e.onBeforeUnmount(()=>l==null?void 0:l.unobserve(f.value)),e.watch([c,h],()=>p(!0)),e.watch([w,i],()=>p()),(n,o)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"wall",ref:f,class:"masonry-wall",style:e.normalizeStyle({display:"flex",gap:`${e.unref(i)}px`})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.value,(a,d)=>(e.openBlock(),e.createElementBlock("div",{key:d,class:"masonry-column","data-index":d,style:e.normalizeStyle({display:"flex","flex-basis":"0px","flex-direction":"column","flex-grow":1,height:["-webkit-max-content","-moz-max-content","max-content"],gap:`${e.unref(i)}px`})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a,t=>(e.openBlock(),e.createElementBlock("div",{key:t,class:"masonry-item"},[e.renderSlot(n.$slots,"default",{item:e.unref(c)[t],index:t},()=>[e.createTextVNode(e.toDisplayString(e.unref(c)[t]),1)])]))),128))],12,r))),128))],4))}});return(()=>{const s=x;return s.install=m=>{m.component("MasonryWall",s)},s})()});
